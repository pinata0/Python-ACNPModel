목표 : 순전파 단계에서 각 요소 간의 의존성이나 상호작용을 추적하는 레이어 개발
예상 : 그래디언트의 연쇄 반응을 명확하게 이해하거나 제어할 수 있게 됨

기존 : 보통 신경망은 요소들 간의 상관관계를 가중치와 비선형성을 통해 암묵적으로 학습
변화 : 어떤 요소의 그래디언트가 변하면 다른 요소의 그래디언트도 따라서 변하는 문제
단순한 병렬 피드포워드 구조에서는 잘 포착되지 않은 관계

현실은 삼체문제처럼 각 요소가 서로에게 영향을 주고받는 동적인 시스템을 생각해보면,
한 요소의 변화가 나머지 시스템 전체에 연쇄적인 영향을 줄 수 있음

따라서 "주가 예측"이라는 문제에 상호작용하는 에이전트들을 도입하고,
이들의 심리적-전략적 상관성을 삼체 문제처럼 시뮬레이션 하는 것

에이전트 구성
국가 (macro-policy)
금리, 법률, 규제 같은 메타 레벨 변수 조정
기업 (market movers)
실적, 투자 발표, 인수합병 등으로 시장에 신호 발생
개인 (herd behavior)
뉴스, 소셜미디어, 여론에 민감하게 반응

상호작용 모델링
기업이 어떤 큰 액션을 취하면 → 개인 투자자들이 따라붙는 심리 (FOMO, herd effect)
국가의 정책 변화 → 기업 투자 전략 변화 → 개인 반응
개인 투자자의 대규모 거래 → 시장 가격 영향 → 다시 기업이 반응

기존의 유사 개념들과의 비교
1. Graph Neural Networks (GNNs)
노드(예: 에이전트) 간의 관계를 엣지로 표현하고, 메시지 패싱을 통해 상호작용을 반영
→ 네가 말한 에이전트 간 상호작용을 구조적으로 반영
차이점: GNN은 정적인 관계 위주 (예: 고정된 그래프), 따라서 더 동적인 관계 (심리, 이벤트 기반 연쇄 반응)
2. Multi-Agent Reinforcement Learning (MARL)
여러 에이전트들이 동시에 학습하고, 서로 영향을 주는 상황
→ 경제 시뮬레이션, 주식 거래 환경 등에서 활용됨
차이점: 강화학습 기반이고, 순전파보다는 정책 학습 중심. 따라서서 순전파에서 상호작용을 넣자는 관점
3. Attention Mechanism (특히 Cross-Attention)
Query-Key-Value 구조로 입력 간의 상관성에 따라 정보 융합
→ 입력 간 의존도를 반영한다는 점에서 유사
차이점: attention은 보통 "입력 요소 간 상관성"이지 "에이전트 간 구조적·심리적 상관성"은 아님
4. Differentiable Physics Simulators
시스템 내 요소들 간의 물리적 상호작용(힘, 속도 등)을 미분 가능한 방식으로 모델링
→ 삼체문제 같은 연쇄 반응 모델링 가능
차이점: 물리계 기반이라 실제 경제 에이전트의 심리·전략적 관계와는 거리가 있음

결론 : 이 모든 것을 살짝씩 섞은 복합적 모델링 방식
GNN : 에이전트 간 구조적 연결성
Attention : 에이전트 간 영향력 가중치 적용
Physics Sim : 연쇄 반응을 모델링 (삼체문제처럼)
MARL : 각 에이전트의 독립된 동기와 전략 반영

주제 :
딥러닝 기반 주가 예측에서 상호작용을 반영한 에이전트 중심 순전파 모델링

초록 :
주식 시장은 기업, 정부, 개인 투자자 등 다양한 주체(에이전트)들이 상호작용하는 복잡계 시스템이다.
본 논문은 기존의 딥러닝 기반 주가 예측 모델들이
에이전트 간의 동적인 상호작용을 충분히 반영하지 못한다는 점에 착안하여,
순전파 과정에서 에이전트 간의 상관관계를 추적하고 반영하는 새로운 레이어 구조를 제안한다.
본 구조는 각 에이전트의 입력에 따라 다른 에이전트의 표현에도 영향을 주는 메커니즘으로,
경제적 연쇄 반응을 시뮬레이션할 수 있다.
본 모델은 실제 시계열 데이터와 에이전트 유형 분류를 기반으로 실험되었으며,
기존 모델 대비 향상된 예측 성능을 보였다.

에이전트의 정의와 확률적 특성 :
에이전트를 확률적 주체로 모델링.
각각의 에이전트는 확률분포를 따라 움직이는 행위자(actor) 로 표현할 수 있음.

국가 (Government)
행동 특성: 낮은 빈도, 높은 영향력
변수 예시: 금리, 정책 발표, 환율 개입 등
통계적 모델링:
일반적으로 **시점별 외생 변수(exogenous)**로 처리
확률적 프로세스: 점진적인 변화, AR(1) 프로세스로 모델링 가능
또는 특정 사건에서만 변화하는 스파이크 분포 (e.g., event-driven process)

기업 (Firms)
행동 특성: 중간 빈도, 중간~높은 영향력
변수 예시: 실적 발표, M&A, 재무지표 등
통계적 모델링:
이산 이벤트 + 연속 지표 조합 (혼합 모형)
종종 시계열 내의 구조적 변동 (structural break) 원인이 됨

개인 투자자 (Individuals)
행동 특성: 높은 빈도, 낮은 개별 영향력, 강한 군집성
변수 예시: 여론, 뉴스 반응, 트위터, Reddit 데이터 등
통계적 모델링:
노이즈 트레이더 (Noise Trader) 모형: 신호보다 감정, 소문 기반 반응
집단행동 (Herding) 모델: 주변 행동에 따라 조건부 확률이 변화

이벤트 모델 구하기 :

국가 에이전트: 거시 경제 지표 기반
데이터 예시 :
금리 (FRED: FEDFUNDS)
물가 (CPI)
실업률, 경기선행지수
정책 발표 뉴스 (예: "연준 금리 인상")
입력 벡터 구성 방법 :
수치형 시계열: 그대로 사용하거나 1차 차분, 표준화
정책 이벤트: 날짜별로 특정 이벤트가 발생했는지 binary vector

기업 에이전트: 실적 및 이벤트 기반
데이터 예시 :
재무제표: 매출, 영업이익, 부채비율, ROE 등
기업 뉴스: 투자, 인수합병, CEO 교체
애널리스트 레포트
입력 벡터 구성 방법 :
정량 지표 → 표준화된 수치
이벤트 → NLP 처리 후 임베딩 (예: FinBERT로 임베딩, 또는 키워드 기반 임베딩)

개인 에이전트: 여론/감정 기반 뉴스·소셜 데이터
데이터 예시
Reddit, Twitter, 뉴스 댓글
Google Trends
Robinhood 상위 보유 종목 변화
입력 벡터 구성 방법
감정 점수: FinBERT / Vader / TextBlob 등으로 긍정-부정 점수 산출
관심 키워드 등장 빈도
실시간 검색량, 댓글 수 변화